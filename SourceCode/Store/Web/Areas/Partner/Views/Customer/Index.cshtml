@using Model
@model CustomerModel
@{
    ViewBag.Title = "Đối tác - Khách hàng";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@section header{
    <link href="~/Content/datatable/dataTables.bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/datatable/responsive.bootstrap.min.css" rel="stylesheet" />
    <link href="~/Content/datatable/buttons.dataTables.min.css" rel="stylesheet" />
}


<div class="row page-header">
    <div class="col-md-9 col-sm-8 col-xs-12">
        <h4 style="float:left;">Đối tác - Khách hàng</h4>
    </div>
    <div class="col-md-3 col-sm-4 col-xs-12 page-tool">
        <span id="btnAdd" data-tooltip="Thêm mới" title="Thêm mới"><i class="fa fa-plus-circle" aria-hidden="true"></i></span>
        <span id="deleteBtn" title="Xóa"><i class="fa fa-window-close" aria-hidden="true"></i></span>
    </div>
</div>
<div class="row">
    
</div>
<div class="row">
    <div class="col-md-12 col-sm-12 col-xs-12">
        <table id="example" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <th>STT</th>
                    <th>Mã KH</th>
                    <th>Tên KH</th>
                    <th>Giới tính</th>
                    <th>SDT</th>
                    <th>Địa chỉ</th>
                </tr>
            </thead>
            <tbody>
                
            </tbody>
        </table>
    </div>
</div>

<div class="modal fade" id="editModel" data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h4 class="modal-title">Thông tin khách hàng</h4>
            </div>
            <div class="modal-body">
                @using (Ajax.BeginForm("save", "customer", 
                    new { area = "partner" }, 
                    new AjaxOptions { HttpMethod = "Post", InsertionMode = InsertionMode.ReplaceWith }, 
                    new { @id = "inputModel" }))
                {
                    @Html.TextBoxFor(m => m.Name, new { @class = "form-control" })
                    @Html.TextBoxFor( m => m.Code, new {  @class = "form-control" })
                    @Html.AntiForgeryToken()
                    <input type="submit" value="Save" />
                }
                @using (Html.BeginForm("save", "customer", new { @class = "form", @id = "form", @enctype = "multipart/form-data" }))
                {
                    @Html.AntiForgeryToken()
                    <div class="row">
                        <div class="col-md-10 col-sm-10 col-xs-12">
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <label>Loại khách hàng</label>&nbsp;&nbsp;
                                    <input type="radio" name="type" value="Person" /> Cá nhân
                                    <input type="radio" name="type" value="Company" /> Công ty
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-2 col-xs-12">

                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-5 col-sm-5 col-xs-12">
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <label>Mẫ khách hàng</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <input type="text" id="customerCode" name="customerCode" class="form-control" maxlength="50" required />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <label>Tên khách hàng</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <input type="text" id="customerName" name="customerName" class="form-control" maxlength="50" required />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <label>Giới tính</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <input type="radio" name="gender" value="Male" /> Nam
                                    <input type="radio" name="gender" value="Female" /> Nữ
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <label>Ngày sinh</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <input type="text" id="birthdate" name="birthdate" class="form-control" maxlength="20" readonly />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <label>Số điện thoại <span class="color-red">*</span></label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <input type="text" id="phone" name="phone" class="form-control" maxlength="15" required />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <label>Email</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <input type="text" id="email" name="email" class="form-control" maxlength="50" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-5 col-sm-5 col-xs-12">
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <label>Mã số thuế</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <input type="text" id="taxcode" name="taxcode" class="form-control" maxlength="20" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <label>Nhóm khách hàng</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <input type="text" id="email" name="email" class="form-control" maxlength="50" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <label>Khu vực</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <input type="text" id="email" name="email" class="form-control" maxlength="50" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <label>Địa chỉ</label>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">
                                    <input type="text" id="email" name="email" class="form-control" maxlength="50" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">

                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12 col-sm-12 col-xs-12 form-group">

                                </div>
                            </div>
                        </div>
                        <div class="col-md-2 col-sm-2 col-xs-12">

                        </div>
                    </div>
                }
            </div>
            <div class="modal-footer">
                <a href="#" data-dismiss="modal" class="btn">Close</a>
                <a href="#" class="btn btn-primary">Save changes</a>

            </div>
        </div>
    </div>
</div>


@section script{
<script src="~/Scripts/jquery.validate.min.js"></script>
<script src="~/Scripts/jquery.validate.unobtrusive.min.js"></script>
    <script src="~/Content/datatable/jquery.dataTables.min.js"></script>
    <script src="~/Content/datatable/dataTables.bootstrap.min.js"></script>
    <script src="~/Content/datatable/dataTables.responsive.min.js"></script>
    <script src="~/Content/datatable/responsive.bootstrap.min.js"></script>
    <script>
        var selected = [];
        $(document).ready(function () {

            $('#example').DataTable({
                responsive: true,
                //For button
                //dom: 'Bfrtip',
                //buttons: [
                //    'colvis'
                //],
                processing: true,
                serverSide: false,
                searching: true,
                ordering: true,
                paging: true,
                pageLength: 10,
                pagingType: 'full_numbers',
                info: true,
                initComplete: function (settings, json) {
                    //Do something after finish
                },
                language: {
                    lengthMenu: 'Hiển thị _MENU_ dòng mỗi trang',
                    zeroRecords: 'Dữ liệu không tồn tại',
                    info: 'Trang _PAGE_/_PAGES_',
                    infoEmpty: '',//'Không tìm thấy kết quả',
                    infoFiltered: '',//'(Tìm kiếm trên _MAX_ dòng)',
                    search: 'Tìm kiếm',
                    processing: 'Đang xử lý',
                    paginate: {
                        first: '<<',
                        previous: '<',
                        next: '>',
                        last: '>>'
                    }
                },
                order: [[1, "asc"]],
                ajax: {
                    url: '/partner/customer/index',
                    type: 'post',
                    data: function (d) {
                        //d.ModuleCode = $('#moduleCode').val()
                    }
                },
                columns: [
                    {
                    orderable: false,
                    width: '40px',
                    render: function (obj, type, data, meta) {
                            var index = meta.row + meta.settings._iDisplayStart + 1;
                            return '<div class="ctn-center text-bold">' + index + '<div/>';
                        }
                    },
                    {
                        data: 'Code',
                        orderable: true,
                        searchable: true,
                        width: '100px'
                    },
                    {
                        data: 'Name',
                        orderable: true,
                        searchable: true
                    },
                    {
                        data: 'GenderString',
                        orderable: true,
                        searchable: true,
                        width: '50px'
                    },
                    {
                        data: 'Phone',
                        orderable: true,
                        searchable: true
                    },
                    {
                        data: 'Address',
                        orderable: true,
                        searchable: true
                    }
                ]
            });
        });

        $('#example tbody').on('click', 'tr', function () {
            console.log('ok');
            var id = this.id;
            var index = $.inArray(id, selected);

            if (index === -1) {
                selected.push(id);
            } else {
                selected.splice(index, 1);
            }

            $(this).toggleClass('selected');
        });


        $(document).on('click', '#btnAdd', function (e) {
            $('#editModel').modal('show');
        });

        $('#inputModel').submit(function () {
            if ($(this).valid()) {
                $.ajax({
                    url: this.action,
                    type: this.method,
                    data: $(this).serialize(),
                    success: function (result) {
                        //$('#result').html(result);
                        console.log(result);
                    },
                    error: function (xhr) {
                        console.log(xhr);
                    }
                });
            }
            return false;
        });
    </script>
}
